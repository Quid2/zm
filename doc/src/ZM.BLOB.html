<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs        #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ZM.BLOB</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier">BLOB</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#blob"><span class="hs-identifier">blob</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#unblob"><span class="hs-identifier">unblob</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier">TypedBLOB</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#typedBLOB"><span class="hs-identifier">typedBLOB</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#typedBLOB_"><span class="hs-identifier">typedBLOB_</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#untypedBLOB"><span class="hs-identifier">untypedBLOB</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier">TypedValue</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#typedValue"><span class="hs-identifier">typedValue</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#untypedValue"><span class="hs-identifier">untypedValue</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.BLOB.html#typeErr"><span class="hs-identifier">typeErr</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Convert</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Model</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Flat</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.HughesPJClass</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="ZM.Abs.html"><span class="hs-identifier">ZM.Abs</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="ZM.BLOB.BLOBList.html"><span class="hs-identifier">ZM.BLOB.BLOBList</span></a></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="ZM.Model.html"><span class="hs-identifier">ZM.Model</span></a></span><span>                       </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="ZM.Type.BLOB.html"><span class="hs-identifier">ZM.Type.BLOB</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Z</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="ZM.Types.html"><span class="hs-identifier">ZM.Types</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="ZM.Util.html"><span class="hs-identifier">ZM.Util</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- |A BLOB is binary value encoded according to a specified encoding (e.g. UTF8)</span><span>
</span><span id="line-42"></span><span id="local-6989586621679164793"><span id="local-6989586621679164794"></span></span><span class="hs-keyword">data</span><span> </span><span id="BLOB"><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-var">BLOB</span></a></span></span><span> </span><span id="local-6989586621679164876"><span class="annot"><a href="#local-6989586621679164876"><span class="hs-identifier hs-type">encoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-43"></span><span>  </span><span id="BLOB"><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-var">BLOB</span></a></span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="encoding"><span class="annot"><span class="annottext">BLOB encoding -&gt; encoding
</span><a href="ZM.BLOB.html#encoding"><span class="hs-identifier hs-var hs-var">encoding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679164876"><span class="hs-identifier hs-type">encoding</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="content"><span class="annot"><span class="annottext">BLOB encoding -&gt; ByteString
</span><a href="ZM.BLOB.html#content"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164786"><span id="local-6989586621679164788"><span class="annot"><span class="annottext">BLOB encoding -&gt; BLOB encoding -&gt; Bool
(BLOB encoding -&gt; BLOB encoding -&gt; Bool)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Bool) -&gt; Eq (BLOB encoding)
forall encoding.
Eq encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c/= :: forall encoding.
Eq encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
== :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c== :: forall encoding.
Eq encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164770"><span id="local-6989586621679164772"><span id="local-6989586621679164774"><span id="local-6989586621679164776"><span id="local-6989586621679164778"><span id="local-6989586621679164780"><span id="local-6989586621679164782"><span class="annot"><span class="annottext">Eq (BLOB encoding)
Eq (BLOB encoding)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Ordering)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Bool)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Bool)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Bool)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; Bool)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding)
-&gt; (BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding)
-&gt; Ord (BLOB encoding)
BLOB encoding -&gt; BLOB encoding -&gt; Bool
BLOB encoding -&gt; BLOB encoding -&gt; Ordering
BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall encoding. Ord encoding =&gt; Eq (BLOB encoding)
forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Ordering
forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
min :: BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
$cmin :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
max :: BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
$cmax :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; BLOB encoding
&gt;= :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c&gt;= :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
&gt; :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c&gt; :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
&lt;= :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c&lt;= :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
&lt; :: BLOB encoding -&gt; BLOB encoding -&gt; Bool
$c&lt; :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Bool
compare :: BLOB encoding -&gt; BLOB encoding -&gt; Ordering
$ccompare :: forall encoding.
Ord encoding =&gt;
BLOB encoding -&gt; BLOB encoding -&gt; Ordering
$cp1Ord :: forall encoding. Ord encoding =&gt; Eq (BLOB encoding)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164767"><span class="annot"><span class="annottext">BLOB encoding -&gt; ()
(BLOB encoding -&gt; ()) -&gt; NFData (BLOB encoding)
forall encoding. NFData encoding =&gt; BLOB encoding -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BLOB encoding -&gt; ()
$crnf :: forall encoding. NFData encoding =&gt; BLOB encoding -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BLOB encoding -&gt; Rep (BLOB encoding) x)
-&gt; (forall x. Rep (BLOB encoding) x -&gt; BLOB encoding)
-&gt; Generic (BLOB encoding)
forall x. Rep (BLOB encoding) x -&gt; BLOB encoding
forall x. BLOB encoding -&gt; Rep (BLOB encoding) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall encoding x. Rep (BLOB encoding) x -&gt; BLOB encoding
forall encoding x. BLOB encoding -&gt; Rep (BLOB encoding) x
$cto :: forall encoding x. Rep (BLOB encoding) x -&gt; BLOB encoding
$cfrom :: forall encoding x. BLOB encoding -&gt; Rep (BLOB encoding) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164757"><span id="local-6989586621679164759"><span id="local-6989586621679164761"><span class="annot"><span class="annottext">Get (BLOB encoding)
BLOB encoding -&gt; Encoding
BLOB encoding -&gt; NumBits -&gt; NumBits
(BLOB encoding -&gt; Encoding)
-&gt; Get (BLOB encoding)
-&gt; (BLOB encoding -&gt; NumBits -&gt; NumBits)
-&gt; Flat (BLOB encoding)
forall encoding. Flat encoding =&gt; Get (BLOB encoding)
forall encoding. Flat encoding =&gt; BLOB encoding -&gt; Encoding
forall encoding.
Flat encoding =&gt;
BLOB encoding -&gt; NumBits -&gt; NumBits
forall a.
(a -&gt; Encoding) -&gt; Get a -&gt; (a -&gt; NumBits -&gt; NumBits) -&gt; Flat a
size :: BLOB encoding -&gt; NumBits -&gt; NumBits
$csize :: forall encoding.
Flat encoding =&gt;
BLOB encoding -&gt; NumBits -&gt; NumBits
decode :: Get (BLOB encoding)
$cdecode :: forall encoding. Flat encoding =&gt; Get (BLOB encoding)
encode :: BLOB encoding -&gt; Encoding
$cencode :: forall encoding. Flat encoding =&gt; BLOB encoding -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Flat</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679164755"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679164751"><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="annot"><a href="#local-6989586621679164755"><span class="hs-identifier hs-type">encoding</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164755"><span class="hs-identifier hs-type">encoding</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{- |
$setup
&gt;&gt;&gt; import Data.Word
&gt;&gt;&gt; b = blob NoEncoding [11::Word8,22,33]

&gt;&gt;&gt; show b
&quot;BLOB {encoding= NoEncoding ,content= [11,22,33] }&quot;

&gt;&gt;&gt; read (show b) == b
True
-}</span><span>
</span><span id="line-62"></span><span id="local-6989586621679164749"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679164744"><span id="local-6989586621679164747"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679164749"><span class="hs-identifier hs-type">encoding</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164749"><span class="hs-identifier hs-type">encoding</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679164742"><span class="annot"><span class="annottext">show :: BLOB encoding -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span id="local-6989586621679164740"><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164740"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span id="local-6989586621679164739"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679164739"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BLOB {encoding=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">encoding -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164740"><span class="hs-identifier hs-var">enc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,content=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; String) -&gt; [Word8] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679164739"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679164736"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679164729"><span id="local-6989586621679164732"><span id="local-6989586621679164734"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679164736"><span class="hs-identifier hs-type">encoding</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164736"><span class="hs-identifier hs-type">encoding</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679164727"><span class="annot"><span class="annottext">readPrec :: ReadPrec (BLOB encoding)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.BLOBList.html#BLOB"><span class="hs-identifier hs-type">BL.BLOB</span></a></span><span> </span><span id="local-6989586621679164724"><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164724"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679164723"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679164723"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">encoding -&gt; ByteString -&gt; BLOB encoding
forall encoding. encoding -&gt; ByteString -&gt; BLOB encoding
</span><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-var">BLOB</span></a></span><span> </span><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164724"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679164723"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BLOB encoding -&gt; BLOB encoding)
-&gt; ReadPrec (BLOB encoding) -&gt; ReadPrec (BLOB encoding)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadPrec (BLOB encoding)
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- |Extract the binary content of a BLOB</span><span>
</span><span id="line-70"></span><span id="local-6989586621679164720"><span class="annot"><a href="ZM.BLOB.html#unblob"><span class="hs-identifier hs-type">unblob</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164720"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span><span>
</span><span id="line-71"></span><span id="unblob"><span class="annot"><span class="annottext">unblob :: BLOB t -&gt; ByteString
</span><a href="ZM.BLOB.html#unblob"><span class="hs-identifier hs-var hs-var">unblob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BLOB t -&gt; ByteString
forall encoding. BLOB encoding -&gt; ByteString
</span><a href="ZM.BLOB.html#content"><span class="hs-identifier hs-var hs-var">content</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- |Build a BLOB from an encoding and a ByteString-like value</span><span>
</span><span id="line-74"></span><span id="local-6989586621679164852"><span id="local-6989586621679164853"><span class="annot"><a href="ZM.BLOB.html#blob"><span class="hs-identifier hs-type">blob</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679164853"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164852"><span class="hs-identifier hs-type">encoding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164853"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164852"><span class="hs-identifier hs-type">encoding</span></a></span></span></span><span>
</span><span id="line-75"></span><span id="blob"><span class="annot"><span class="annottext">blob :: encoding -&gt; a -&gt; BLOB encoding
</span><a href="ZM.BLOB.html#blob"><span class="hs-identifier hs-var hs-var">blob</span></a></span></span><span> </span><span id="local-6989586621679164719"><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164719"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">encoding -&gt; ByteString -&gt; BLOB encoding
forall encoding. encoding -&gt; ByteString -&gt; BLOB encoding
</span><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-var">BLOB</span></a></span><span> </span><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164719"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; BLOB encoding)
-&gt; (a -&gt; ByteString) -&gt; a -&gt; BLOB encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. AsByteString a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">toByteString</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- |A typed value, a Flat encoded value and its absolute type</span><span>
</span><span id="line-78"></span><span id="local-6989586621679164715"><span id="local-6989586621679164716"></span></span><span class="hs-keyword">data</span><span> </span><span id="TypedBLOB"><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-var">TypedBLOB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span id="TypedBLOB"><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-var">TypedBLOB</span></a></span></span><span> </span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="ZM.Type.BLOB.html#FlatEncoding"><span class="hs-identifier hs-type">Z.FlatEncoding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164710"><span id="local-6989586621679164712"><span class="annot"><span class="annottext">TypedBLOB -&gt; TypedBLOB -&gt; Bool
(TypedBLOB -&gt; TypedBLOB -&gt; Bool)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Bool) -&gt; Eq TypedBLOB
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c/= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
== :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c== :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164695"><span id="local-6989586621679164697"><span id="local-6989586621679164699"><span id="local-6989586621679164701"><span id="local-6989586621679164703"><span id="local-6989586621679164705"><span id="local-6989586621679164707"><span class="annot"><span class="annottext">Eq TypedBLOB
Eq TypedBLOB
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Ordering)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Bool)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Bool)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Bool)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; Bool)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB)
-&gt; (TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB)
-&gt; Ord TypedBLOB
TypedBLOB -&gt; TypedBLOB -&gt; Bool
TypedBLOB -&gt; TypedBLOB -&gt; Ordering
TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB
$cmin :: TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB
max :: TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB
$cmax :: TypedBLOB -&gt; TypedBLOB -&gt; TypedBLOB
&gt;= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c&gt;= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
&gt; :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c&gt; :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
&lt;= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c&lt;= :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
&lt; :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
$c&lt; :: TypedBLOB -&gt; TypedBLOB -&gt; Bool
compare :: TypedBLOB -&gt; TypedBLOB -&gt; Ordering
$ccompare :: TypedBLOB -&gt; TypedBLOB -&gt; Ordering
$cp1Ord :: Eq TypedBLOB
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164689"><span id="local-6989586621679164691"><span id="local-6989586621679164693"><span class="annot"><span class="annottext">NumBits -&gt; TypedBLOB -&gt; ShowS
[TypedBLOB] -&gt; ShowS
TypedBLOB -&gt; String
(NumBits -&gt; TypedBLOB -&gt; ShowS)
-&gt; (TypedBLOB -&gt; String)
-&gt; ([TypedBLOB] -&gt; ShowS)
-&gt; Show TypedBLOB
forall a.
(NumBits -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypedBLOB] -&gt; ShowS
$cshowList :: [TypedBLOB] -&gt; ShowS
show :: TypedBLOB -&gt; String
$cshow :: TypedBLOB -&gt; String
showsPrec :: NumBits -&gt; TypedBLOB -&gt; ShowS
$cshowsPrec :: NumBits -&gt; TypedBLOB -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164687"><span class="annot"><span class="annottext">TypedBLOB -&gt; ()
(TypedBLOB -&gt; ()) -&gt; NFData TypedBLOB
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: TypedBLOB -&gt; ()
$crnf :: TypedBLOB -&gt; ()
</span><a href="#local-6989586621679164687"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. TypedBLOB -&gt; Rep TypedBLOB x)
-&gt; (forall x. Rep TypedBLOB x -&gt; TypedBLOB) -&gt; Generic TypedBLOB
forall x. Rep TypedBLOB x -&gt; TypedBLOB
forall x. TypedBLOB -&gt; Rep TypedBLOB x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep TypedBLOB x -&gt; TypedBLOB
$cfrom :: forall x. TypedBLOB -&gt; Rep TypedBLOB x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164679"><span id="local-6989586621679164681"><span id="local-6989586621679164683"><span class="annot"><span class="annottext">Get TypedBLOB
TypedBLOB -&gt; Encoding
TypedBLOB -&gt; NumBits -&gt; NumBits
(TypedBLOB -&gt; Encoding)
-&gt; Get TypedBLOB
-&gt; (TypedBLOB -&gt; NumBits -&gt; NumBits)
-&gt; Flat TypedBLOB
forall a.
(a -&gt; Encoding) -&gt; Get a -&gt; (a -&gt; NumBits -&gt; NumBits) -&gt; Flat a
size :: TypedBLOB -&gt; NumBits -&gt; NumBits
$csize :: TypedBLOB -&gt; NumBits -&gt; NumBits
decode :: Get TypedBLOB
$cdecode :: Get TypedBLOB
encode :: TypedBLOB -&gt; Encoding
$cencode :: TypedBLOB -&gt; Encoding
</span><a href="#local-6989586621679164679"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Flat</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164675"><span class="annot"><span class="annottext">Typeable TypedBLOB
AsType (Ana TypedBLOB)
Typeable TypedBLOB
-&gt; AsType (Ana TypedBLOB)
-&gt; (Proxy TypedBLOB -&gt; State Env HType)
-&gt; Model TypedBLOB
Proxy TypedBLOB -&gt; State Env HType
forall a.
Typeable a
-&gt; AsType (Ana a) -&gt; (Proxy a -&gt; State Env HType) -&gt; Model a
envType :: Proxy TypedBLOB -&gt; State Env HType
$cenvType :: Proxy TypedBLOB -&gt; State Env HType
$cp2Model :: AsType (Ana TypedBLOB)
$cp1Model :: Typeable TypedBLOB
</span><a href="#local-6989586621679164675"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Model</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- |Build a TypedBLOB out of a value</span><span>
</span><span id="line-83"></span><span class="annot"><a href="ZM.BLOB.html#typedBLOB"><span class="hs-identifier hs-type">typedBLOB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164674"><span class="annot"><a href="#local-6989586621679164674"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="annot"><a href="#local-6989586621679164674"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Flat</span></span><span> </span><span class="annot"><a href="#local-6989586621679164674"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164674"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-type">TypedBLOB</span></a></span><span>
</span><span id="line-84"></span><span id="typedBLOB"><span class="annot"><span class="annottext">typedBLOB :: a -&gt; TypedBLOB
</span><a href="ZM.BLOB.html#typedBLOB"><span class="hs-identifier hs-var hs-var">typedBLOB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; a -&gt; TypedBLOB
forall a. Flat a =&gt; AbsType -&gt; a -&gt; TypedBLOB
</span><a href="ZM.BLOB.html#typedBLOB_"><span class="hs-identifier hs-var">typedBLOB_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; AbsType
forall a. Model a =&gt; Proxy a -&gt; AbsType
</span><a href="ZM.Abs.html#absType"><span class="hs-identifier hs-var">absType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164674"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- |Build a TypedBLOB out of a type and a value</span><span>
</span><span id="line-87"></span><span id="local-6989586621679164859"><span class="annot"><a href="ZM.BLOB.html#typedBLOB_"><span class="hs-identifier hs-type">typedBLOB_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Flat</span></span><span> </span><span class="annot"><a href="#local-6989586621679164859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-type">TypedBLOB</span></a></span></span><span>
</span><span id="line-88"></span><span id="typedBLOB_"><span class="annot"><span class="annottext">typedBLOB_ :: AbsType -&gt; a -&gt; TypedBLOB
</span><a href="ZM.BLOB.html#typedBLOB_"><span class="hs-identifier hs-var hs-var">typedBLOB_</span></a></span></span><span> </span><span id="local-6989586621679164671"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164671"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679164670"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164670"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; BLOB FlatEncoding -&gt; TypedBLOB
</span><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-var">TypedBLOB</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164671"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlatEncoding -&gt; ByteString -&gt; BLOB FlatEncoding
forall a encoding. AsByteString a =&gt; encoding -&gt; a -&gt; BLOB encoding
</span><a href="ZM.BLOB.html#blob"><span class="hs-identifier hs-var">blob</span></a></span><span> </span><span class="annot"><span class="annottext">FlatEncoding
</span><a href="ZM.Type.BLOB.html#FlatEncoding"><span class="hs-identifier hs-var">Z.FlatEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; BLOB FlatEncoding)
-&gt; (a -&gt; ByteString) -&gt; a -&gt; BLOB FlatEncoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. Flat a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">flat</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; BLOB FlatEncoding) -&gt; a -&gt; BLOB FlatEncoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164670"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- |A typed value, a value and its absolute type</span><span>
</span><span id="line-91"></span><span id="local-6989586621679164666"><span id="local-6989586621679164667"></span></span><span class="hs-keyword">data</span><span> </span><span id="TypedValue"><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-var">TypedValue</span></a></span></span><span> </span><span id="local-6989586621679164831"><span class="annot"><a href="#local-6989586621679164831"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span id="TypedValue"><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-var">TypedValue</span></a></span></span><span> </span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164831"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679164661"><span id="local-6989586621679164663"><span class="annot"><span class="annottext">TypedValue a -&gt; TypedValue a -&gt; Bool
(TypedValue a -&gt; TypedValue a -&gt; Bool)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Bool) -&gt; Eq (TypedValue a)
forall a. Eq a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c/= :: forall a. Eq a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
== :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c== :: forall a. Eq a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164646"><span id="local-6989586621679164648"><span id="local-6989586621679164650"><span id="local-6989586621679164652"><span id="local-6989586621679164654"><span id="local-6989586621679164656"><span id="local-6989586621679164658"><span class="annot"><span class="annottext">Eq (TypedValue a)
Eq (TypedValue a)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Ordering)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Bool)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Bool)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Bool)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; Bool)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; TypedValue a)
-&gt; (TypedValue a -&gt; TypedValue a -&gt; TypedValue a)
-&gt; Ord (TypedValue a)
TypedValue a -&gt; TypedValue a -&gt; Bool
TypedValue a -&gt; TypedValue a -&gt; Ordering
TypedValue a -&gt; TypedValue a -&gt; TypedValue a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (TypedValue a)
forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Ordering
forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; TypedValue a
min :: TypedValue a -&gt; TypedValue a -&gt; TypedValue a
$cmin :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; TypedValue a
max :: TypedValue a -&gt; TypedValue a -&gt; TypedValue a
$cmax :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; TypedValue a
&gt;= :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
&gt; :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
&lt;= :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
&lt; :: TypedValue a -&gt; TypedValue a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Bool
compare :: TypedValue a -&gt; TypedValue a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; TypedValue a -&gt; TypedValue a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (TypedValue a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164640"><span id="local-6989586621679164642"><span id="local-6989586621679164644"><span class="annot"><span class="annottext">NumBits -&gt; TypedValue a -&gt; ShowS
[TypedValue a] -&gt; ShowS
TypedValue a -&gt; String
(NumBits -&gt; TypedValue a -&gt; ShowS)
-&gt; (TypedValue a -&gt; String)
-&gt; ([TypedValue a] -&gt; ShowS)
-&gt; Show (TypedValue a)
forall a. Show a =&gt; NumBits -&gt; TypedValue a -&gt; ShowS
forall a. Show a =&gt; [TypedValue a] -&gt; ShowS
forall a. Show a =&gt; TypedValue a -&gt; String
forall a.
(NumBits -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypedValue a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [TypedValue a] -&gt; ShowS
show :: TypedValue a -&gt; String
$cshow :: forall a. Show a =&gt; TypedValue a -&gt; String
showsPrec :: NumBits -&gt; TypedValue a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; NumBits -&gt; TypedValue a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164636"><span id="local-6989586621679164638"><span class="annot"><span class="annottext">a -&gt; TypedValue b -&gt; TypedValue a
(a -&gt; b) -&gt; TypedValue a -&gt; TypedValue b
(forall a b. (a -&gt; b) -&gt; TypedValue a -&gt; TypedValue b)
-&gt; (forall a b. a -&gt; TypedValue b -&gt; TypedValue a)
-&gt; Functor TypedValue
forall a b. a -&gt; TypedValue b -&gt; TypedValue a
forall a b. (a -&gt; b) -&gt; TypedValue a -&gt; TypedValue b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; TypedValue b -&gt; TypedValue a
$c&lt;$ :: forall a b. a -&gt; TypedValue b -&gt; TypedValue a
fmap :: (a -&gt; b) -&gt; TypedValue a -&gt; TypedValue b
$cfmap :: forall a b. (a -&gt; b) -&gt; TypedValue a -&gt; TypedValue b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164633"><span class="annot"><span class="annottext">TypedValue a -&gt; ()
(TypedValue a -&gt; ()) -&gt; NFData (TypedValue a)
forall a. NFData a =&gt; TypedValue a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: TypedValue a -&gt; ()
$crnf :: forall a. NFData a =&gt; TypedValue a -&gt; ()
</span><a href="#local-6989586621679164633"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. TypedValue a -&gt; Rep (TypedValue a) x)
-&gt; (forall x. Rep (TypedValue a) x -&gt; TypedValue a)
-&gt; Generic (TypedValue a)
forall x. Rep (TypedValue a) x -&gt; TypedValue a
forall x. TypedValue a -&gt; Rep (TypedValue a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (TypedValue a) x -&gt; TypedValue a
forall a x. TypedValue a -&gt; Rep (TypedValue a) x
$cto :: forall a x. Rep (TypedValue a) x -&gt; TypedValue a
$cfrom :: forall a x. TypedValue a -&gt; Rep (TypedValue a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679164625"><span id="local-6989586621679164627"><span id="local-6989586621679164629"><span class="annot"><span class="annottext">Get (TypedValue a)
TypedValue a -&gt; Encoding
TypedValue a -&gt; NumBits -&gt; NumBits
(TypedValue a -&gt; Encoding)
-&gt; Get (TypedValue a)
-&gt; (TypedValue a -&gt; NumBits -&gt; NumBits)
-&gt; Flat (TypedValue a)
forall a. Flat a =&gt; Get (TypedValue a)
forall a. Flat a =&gt; TypedValue a -&gt; Encoding
forall a. Flat a =&gt; TypedValue a -&gt; NumBits -&gt; NumBits
forall a.
(a -&gt; Encoding) -&gt; Get a -&gt; (a -&gt; NumBits -&gt; NumBits) -&gt; Flat a
size :: TypedValue a -&gt; NumBits -&gt; NumBits
$csize :: forall a. Flat a =&gt; TypedValue a -&gt; NumBits -&gt; NumBits
decode :: Get (TypedValue a)
$cdecode :: forall a. Flat a =&gt; Get (TypedValue a)
encode :: TypedValue a -&gt; Encoding
$cencode :: forall a. Flat a =&gt; TypedValue a -&gt; Encoding
</span><a href="#local-6989586621679164625"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Flat</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- |Build a TypedValue out of a value</span><span>
</span><span id="line-96"></span><span class="annot"><a href="ZM.BLOB.html#typedValue"><span class="hs-identifier hs-type">typedValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164624"><span class="annot"><a href="#local-6989586621679164624"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="annot"><a href="#local-6989586621679164624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679164624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-type">TypedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164624"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-97"></span><span id="typedValue"><span class="annot"><span class="annottext">typedValue :: a -&gt; TypedValue a
</span><a href="ZM.BLOB.html#typedValue"><span class="hs-identifier hs-var hs-var">typedValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; a -&gt; TypedValue a
forall a. AbsType -&gt; a -&gt; TypedValue a
</span><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-var">TypedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; AbsType
forall a. Model a =&gt; Proxy a -&gt; AbsType
</span><a href="ZM.Abs.html#absType"><span class="hs-identifier hs-var">absType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- |Type-checked extraction of a value of a known type from a decoded TypedBLOB</span><span>
</span><span id="line-100"></span><span class="annot"><a href="ZM.BLOB.html#untypedBLOB"><span class="hs-identifier hs-type">untypedBLOB</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679164623"><span class="annot"><a href="#local-6989586621679164623"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Flat</span></span><span> </span><span class="annot"><a href="#local-6989586621679164623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="annot"><a href="#local-6989586621679164623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoded</span></span><span> </span><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-type">TypedBLOB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Types.html#TypedDecoded"><span class="hs-identifier hs-type">TypedDecoded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164623"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-102"></span><span id="untypedBLOB"><span class="annot"><span class="annottext">untypedBLOB :: Decoded TypedBLOB -&gt; TypedDecoded a
</span><a href="ZM.BLOB.html#untypedBLOB"><span class="hs-identifier hs-var hs-var">untypedBLOB</span></a></span></span><span> </span><span id="local-6989586621679164622"><span class="annot"><span class="annottext">Decoded TypedBLOB
</span><a href="#local-6989586621679164622"><span class="hs-identifier hs-var">ea</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Decoded TypedBLOB
</span><a href="#local-6989586621679164622"><span class="hs-identifier hs-var">ea</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679164621"><span class="annot"><span class="annottext">DecodeException
</span><a href="#local-6989586621679164621"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypedDecodeException -&gt; TypedDecoded a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(TypedDecodeException -&gt; TypedDecoded a)
-&gt; (DecodeException -&gt; TypedDecodeException)
-&gt; DecodeException
-&gt; TypedDecoded a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodeException -&gt; TypedDecodeException
</span><a href="ZM.Types.html#DecodeError"><span class="hs-identifier hs-var">DecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">(DecodeException -&gt; TypedDecoded a)
-&gt; DecodeException -&gt; TypedDecoded a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DecodeException
</span><a href="#local-6989586621679164621"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#TypedBLOB"><span class="hs-identifier hs-type">TypedBLOB</span></a></span><span> </span><span id="local-6989586621679164619"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164619"><span class="hs-identifier hs-var">typ'</span></a></span></span><span> </span><span id="local-6989586621679164618"><span class="annot"><span class="annottext">BLOB FlatEncoding
</span><a href="#local-6989586621679164618"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164617"><span class="annot"><span class="annottext">typ :: AbsType
</span><a href="#local-6989586621679164617"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; AbsType
forall a. Model a =&gt; Proxy a -&gt; AbsType
</span><a href="ZM.Abs.html#absType"><span class="hs-identifier hs-var">absType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679164623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164619"><span class="hs-identifier hs-var">typ'</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; AbsType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164617"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-107"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; AbsType -&gt; TypedDecoded a
forall a. AbsType -&gt; AbsType -&gt; TypedDecoded a
</span><a href="ZM.BLOB.html#typeErr"><span class="hs-identifier hs-var">typeErr</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164617"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164619"><span class="hs-identifier hs-var">typ'</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(DecodeException -&gt; TypedDecodeException)
-&gt; Either DecodeException a -&gt; TypedDecoded a
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">DecodeException -&gt; TypedDecodeException
</span><a href="ZM.Types.html#DecodeError"><span class="hs-identifier hs-var">DecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DecodeException a -&gt; TypedDecoded a)
-&gt; (ByteString -&gt; Either DecodeException a)
-&gt; ByteString
-&gt; TypedDecoded a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either DecodeException a
forall a b. (Flat a, AsByteString b) =&gt; b -&gt; Decoded a
</span><span class="hs-identifier hs-var">unflat</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; TypedDecoded a) -&gt; ByteString -&gt; TypedDecoded a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BLOB FlatEncoding -&gt; ByteString
forall encoding. BLOB encoding -&gt; ByteString
</span><a href="ZM.BLOB.html#unblob"><span class="hs-identifier hs-var">unblob</span></a></span><span> </span><span class="annot"><span class="annottext">BLOB FlatEncoding
</span><a href="#local-6989586621679164618"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- |Type-checked extraction of a value of a known type from a decoded TypedValue</span><span>
</span><span id="line-111"></span><span id="local-6989586621679164613"><span class="annot"><a href="ZM.BLOB.html#untypedValue"><span class="hs-identifier hs-type">untypedValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Model</span></span><span> </span><span class="annot"><a href="#local-6989586621679164613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-type">TypedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Types.html#TypedDecoded"><span class="hs-identifier hs-type">TypedDecoded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164613"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-112"></span><span id="untypedValue"><span class="annot"><span class="annottext">untypedValue :: Decoded (TypedValue a) -&gt; TypedDecoded a
</span><a href="ZM.BLOB.html#untypedValue"><span class="hs-identifier hs-var hs-var">untypedValue</span></a></span></span><span> </span><span id="local-6989586621679164612"><span class="annot"><span class="annottext">Decoded (TypedValue a)
</span><a href="#local-6989586621679164612"><span class="hs-identifier hs-var">ea</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Decoded (TypedValue a)
</span><a href="#local-6989586621679164612"><span class="hs-identifier hs-var">ea</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679164611"><span class="annot"><span class="annottext">DecodeException
</span><a href="#local-6989586621679164611"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypedDecodeException -&gt; TypedDecoded a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(TypedDecodeException -&gt; TypedDecoded a)
-&gt; (DecodeException -&gt; TypedDecodeException)
-&gt; DecodeException
-&gt; TypedDecoded a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodeException -&gt; TypedDecodeException
</span><a href="ZM.Types.html#DecodeError"><span class="hs-identifier hs-var">DecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">(DecodeException -&gt; TypedDecoded a)
-&gt; DecodeException -&gt; TypedDecoded a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DecodeException
</span><a href="#local-6989586621679164611"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-type">TypedValue</span></a></span><span> </span><span id="local-6989586621679164610"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164610"><span class="hs-identifier hs-var">typ'</span></a></span></span><span> </span><span id="local-6989586621679164609"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164609"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679164608"><span class="annot"><span class="annottext">typ :: AbsType
</span><a href="#local-6989586621679164608"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; AbsType
forall a. Model a =&gt; Proxy a -&gt; AbsType
</span><a href="ZM.Abs.html#absType"><span class="hs-identifier hs-var">absType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Proxy a
forall a. a -&gt; Proxy a
</span><a href="ZM.Util.html#proxyOf"><span class="hs-identifier hs-var">proxyOf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164609"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164610"><span class="hs-identifier hs-var">typ'</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; AbsType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164608"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; AbsType -&gt; TypedDecoded a
forall a. AbsType -&gt; AbsType -&gt; TypedDecoded a
</span><a href="ZM.BLOB.html#typeErr"><span class="hs-identifier hs-var">typeErr</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164608"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164610"><span class="hs-identifier hs-var">typ'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; TypedDecoded a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164609"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- |Return a WrongType error</span><span>
</span><span id="line-119"></span><span id="local-6989586621679164823"><span class="annot"><a href="ZM.BLOB.html#typeErr"><span class="hs-identifier hs-type">typeErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Types.html#TypedDecoded"><span class="hs-identifier hs-type">TypedDecoded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164823"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-120"></span><span id="typeErr"><span class="annot"><span class="annottext">typeErr :: AbsType -&gt; AbsType -&gt; TypedDecoded a
</span><a href="ZM.BLOB.html#typeErr"><span class="hs-identifier hs-var hs-var">typeErr</span></a></span></span><span> </span><span id="local-6989586621679164606"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164606"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span id="local-6989586621679164605"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164605"><span class="hs-identifier hs-var">typ'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedDecodeException -&gt; TypedDecoded a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(TypedDecodeException -&gt; TypedDecoded a)
-&gt; TypedDecodeException -&gt; TypedDecoded a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; AbsType -&gt; TypedDecodeException
</span><a href="ZM.Types.html#WrongType"><span class="hs-identifier hs-var">WrongType</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164606"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164605"><span class="hs-identifier hs-var">typ'</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679164603"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679164598"><span id="local-6989586621679164601"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679164603"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-type">TypedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164603"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679164596"><span class="annot"><span class="annottext">pPrint :: TypedValue a -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#TypedValue"><span class="hs-identifier hs-type">TypedValue</span></a></span><span> </span><span id="local-6989586621679164594"><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164594"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679164593"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164593"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679164593"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">AbsType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">AbsType
</span><a href="#local-6989586621679164594"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679164590"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679164585"><span id="local-6989586621679164588"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679164590"><span class="hs-identifier hs-type">encoding</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679164590"><span class="hs-identifier hs-type">encoding</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679164584"><span class="annot"><span class="annottext">pPrint :: BLOB encoding -&gt; Doc
</span><a href="#local-6989586621679164584"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span id="local-6989586621679164583"><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164583"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span id="local-6989586621679164582"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679164582"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BLOB&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">encoding -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">encoding
</span><a href="#local-6989586621679164583"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679164582"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679164577"><span id="local-6989586621679164580"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="ZM.Type.BLOB.html#UTF8Encoding"><span class="hs-identifier hs-type">UTF8Encoding</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pPrint</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="ZM.Type.BLOB.html#UTF8Encoding"><span class="hs-identifier hs-type">UTF8Encoding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679164576"><span class="annot"><span class="annottext">pPrint :: BLOB UTF8Encoding -&gt; Doc
</span><a href="#local-6989586621679164576"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Doc)
-&gt; (BLOB UTF8Encoding -&gt; Text) -&gt; BLOB UTF8Encoding -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (BLOB UTF8Encoding -&gt; ByteString) -&gt; BLOB UTF8Encoding -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BLOB UTF8Encoding -&gt; ByteString
forall encoding. BLOB encoding -&gt; ByteString
</span><a href="ZM.BLOB.html#unblob"><span class="hs-identifier hs-var">unblob</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679164570"><span id="local-6989586621679164573"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.BLOB.html#BLOB"><span class="hs-identifier hs-type">BLOB</span></a></span><span> </span><span class="annot"><a href="ZM.Type.BLOB.html#UTF16LEEncoding"><span class="hs-identifier hs-type">UTF16LEEncoding</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679164569"><span class="annot"><span class="annottext">pPrint :: BLOB UTF16LEEncoding -&gt; Doc
</span><a href="#local-6989586621679164569"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Doc)
-&gt; (BLOB UTF16LEEncoding -&gt; Text) -&gt; BLOB UTF16LEEncoding -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf16LE</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (BLOB UTF16LEEncoding -&gt; ByteString)
-&gt; BLOB UTF16LEEncoding
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BLOB UTF16LEEncoding -&gt; ByteString
forall encoding. BLOB encoding -&gt; ByteString
</span><a href="ZM.BLOB.html#unblob"><span class="hs-identifier hs-var">unblob</span></a></span><span>
</span><span id="line-134"></span></pre></body></html>