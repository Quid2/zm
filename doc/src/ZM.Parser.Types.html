<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_DLjcAhSx6dIK29ntJy1lzn"><span id="%24con2tag_IC8l8n9zb4K7Atvoouuhjk"><span id="%24con2tag_CVcgmHGVb8XCz29aIBMxj4"></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ZM.Parser.Types</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Parser"><span class="hs-identifier">Parser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#ADTParts"><span class="hs-identifier">ADTParts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#asTypeName"><span class="hs-identifier">asTypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#hasName"><span class="hs-identifier">hasName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#hasRef"><span class="hs-identifier">hasRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-comment">-- typeNameName,</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-comment">-- typeNameRef,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#TypeName"><span class="hs-identifier">TypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#localTypeName"><span class="hs-identifier">localTypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#absTypeName"><span class="hs-identifier">absTypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-comment">-- , asQualName</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#At"><span class="hs-identifier">At</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#AtId"><span class="hs-identifier">AtId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#AtAbsName"><span class="hs-identifier">AtAbsName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#AtError"><span class="hs-identifier">AtError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Range"><span class="hs-identifier">Range</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier">Val</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier">ValF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Constr"><span class="hs-identifier">Constr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VInteger"><span class="hs-identifier">VInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VChar"><span class="hs-identifier">VChar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VString"><span class="hs-identifier">VString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VFloat"><span class="hs-identifier">VFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VArray"><span class="hs-identifier">VArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#PBind"><span class="hs-identifier">PBind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#PWild"><span class="hs-identifier">PWild</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-identifier">Fix</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier">Annotate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier">Literal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Binder"><span class="hs-identifier">Binder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#valType"><span class="hs-identifier">valType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#valName"><span class="hs-identifier">valName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#valBits"><span class="hs-identifier">valBits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#valFields"><span class="hs-identifier">valFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-identifier">Void</span></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Void1"><span class="hs-identifier">Void1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either.Validation</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either.Validation</span></span><span>
</span><span id="line-56"></span><span class="hs-comment">--hiding (Value)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Fix</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.These.Extra.html"><span class="hs-identifier">Data.These.Extra</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Label</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-keyword">label</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ZM.html"><span class="hs-identifier">ZM</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="ZM.Parser.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- TODO: generalise to any textual type</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- |A parsed ADT</span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="ADTParts"><span class="annot"><a href="ZM.Parser.Types.html#ADTParts"><span class="hs-identifier hs-var">ADTParts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ADTParts"><span class="annot"><a href="ZM.Parser.Types.html#ADTParts"><span class="hs-identifier hs-var">ADTParts</span></a></span></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="name"><span class="annot"><span class="annottext">ADTParts -&gt; AtAbsName
</span><a href="ZM.Parser.Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#AtAbsName"><span class="hs-identifier hs-type">AtAbsName</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="vars"><span class="annot"><span class="annottext">ADTParts -&gt; [AtId]
</span><a href="ZM.Parser.Types.html#vars"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ZM.Parser.Types.html#AtId"><span class="hs-identifier hs-type">AtId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="constrs"><span class="annot"><span class="annottext">ADTParts -&gt; [(AtId, Fields AtId AtAbsName)]
</span><a href="ZM.Parser.Types.html#constrs"><span class="hs-identifier hs-var hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#AtId"><span class="hs-identifier hs-type">AtId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fields</span></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#AtId"><span class="hs-identifier hs-type">AtId</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#AtAbsName"><span class="hs-identifier hs-type">AtAbsName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165682"><span id="local-6989586621679165684"><span id="local-6989586621679165686"><span class="annot"><span class="annottext">Int -&gt; ADTParts -&gt; ShowS
[ADTParts] -&gt; ShowS
ADTParts -&gt; String
(Int -&gt; ADTParts -&gt; ShowS)
-&gt; (ADTParts -&gt; String) -&gt; ([ADTParts] -&gt; ShowS) -&gt; Show ADTParts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ADTParts] -&gt; ShowS
$cshowList :: [ADTParts] -&gt; ShowS
show :: ADTParts -&gt; String
$cshow :: ADTParts -&gt; String
showsPrec :: Int -&gt; ADTParts -&gt; ShowS
$cshowsPrec :: Int -&gt; ADTParts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165676"><span id="local-6989586621679165679"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#ADTParts"><span class="hs-identifier hs-type">ADTParts</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pPrint</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#ADTParts"><span class="hs-identifier hs-type">ADTParts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679165673"><span class="annot"><span class="annottext">pPrint :: ADTParts -&gt; Doc
</span><a href="#local-6989586621679165673"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span id="local-6989586621679165672"><span class="annot"><span class="annottext">ADTParts
</span><a href="#local-6989586621679165672"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">AtAbsName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ADTParts -&gt; AtAbsName
</span><a href="ZM.Parser.Types.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ADTParts
</span><a href="#local-6989586621679165672"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AtId -&gt; Doc) -&gt; [AtId] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AtId -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">([AtId] -&gt; [Doc]) -&gt; [AtId] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ADTParts -&gt; [AtId]
</span><a href="ZM.Parser.Types.html#vars"><span class="hs-identifier hs-var hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">ADTParts
</span><a href="#local-6989586621679165672"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-82"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; [Doc]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; |&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((AtId, Fields AtId AtAbsName) -&gt; Doc)
-&gt; [(AtId, Fields AtId AtAbsName)] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(AtId, Fields AtId AtAbsName) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ADTParts -&gt; [(AtId, Fields AtId AtAbsName)]
</span><a href="ZM.Parser.Types.html#constrs"><span class="hs-identifier hs-var hs-var">constrs</span></a></span><span> </span><span class="annot"><span class="annottext">ADTParts
</span><a href="#local-6989586621679165672"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | A data type name can be either local, or absolute, or both: &quot;Bool&quot; | &quot;.K306f1981b41c&quot; | &quot;Bool.K306f1981b41c&quot; </span><span>
</span><span id="line-85"></span><span class="hs-keyword">type</span><span> </span><span id="TypeName"><span class="annot"><a href="ZM.Parser.Types.html#TypeName"><span class="hs-identifier hs-var">TypeName</span></a></span></span><span> </span><span id="local-6989586621679165666"><span class="annot"><a href="#local-6989586621679165666"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165666"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="ZM.Types.html#AbsRef"><span class="hs-identifier hs-type">AbsRef</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- TODO: Convert to These l AbsRef</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- data TypeName l =</span><span>
</span><span id="line-89"></span><span class="hs-comment">--   TypeName l</span><span>
</span><span id="line-90"></span><span class="hs-comment">--           (Maybe AbsRef)</span><span>
</span><span id="line-91"></span><span class="hs-comment">--   deriving (Show, Functor, Ord, Eq)</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- localName (TypeName l _) = l</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- asQualName (TypeName l Nothing) = QualName &quot;&quot; &quot;&quot; (prettyShow l)</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- asQualName (TypeName l (Just ref)) = QualName &quot;&quot; (prettyShow l) (prettyShow ref)</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- instance Pretty n =&gt; Pretty (TypeName n) where</span><span>
</span><span id="line-96"></span><span class="hs-comment">--   pPrint (TypeName n Nothing) = pPrint n</span><span>
</span><span id="line-97"></span><span class="hs-comment">--   pPrint (TypeName n (Just r)) = pPrint n &lt;&gt; char '.' &lt;&gt; pPrint r</span><span>
</span><span id="line-98"></span><span id="local-6989586621679165664"><span id="local-6989586621679165665"><span class="annot"><a href="ZM.Parser.Types.html#asTypeName"><span class="hs-identifier hs-type">asTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679165665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679165664"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165664"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-99"></span><span id="asTypeName"><span class="annot"><span class="annottext">asTypeName :: Maybe a -&gt; Maybe b -&gt; These a b
</span><a href="ZM.Parser.Types.html#asTypeName"><span class="hs-identifier hs-var hs-var">asTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe b -&gt; These a b
forall a b. Maybe a -&gt; Maybe b -&gt; These a b
</span><a href="Data.These.Extra.html#aThese"><span class="hs-identifier hs-var">aThese</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- typeNameName :: TypeName l -&gt; l</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- typeNameName = fromThis</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- typeNameRef :: TypeName l -&gt; AbsRef</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- typeNameRef = fromThat</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679165661"><span id="local-6989586621679165662"><span class="annot"><a href="ZM.Parser.Types.html#hasName"><span class="hs-identifier hs-type">hasName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165662"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165661"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-108"></span><span id="hasName"><span class="annot"><span class="annottext">hasName :: These a b -&gt; Bool
</span><a href="ZM.Parser.Types.html#hasName"><span class="hs-identifier hs-var hs-var">hasName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">These a b -&gt; Bool
forall a b. These a b -&gt; Bool
</span><a href="Data.These.Extra.html#hasThis"><span class="hs-identifier hs-var">hasThis</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679165658"><span id="local-6989586621679165659"><span class="annot"><a href="ZM.Parser.Types.html#hasRef"><span class="hs-identifier hs-type">hasRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165659"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-111"></span><span id="hasRef"><span class="annot"><span class="annottext">hasRef :: These a1 a -&gt; Bool
</span><a href="ZM.Parser.Types.html#hasRef"><span class="hs-identifier hs-var hs-var">hasRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">These a1 a -&gt; Bool
forall a b. These a b -&gt; Bool
</span><a href="Data.These.Extra.html#hasThat"><span class="hs-identifier hs-var">hasThat</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679165655"><span id="local-6989586621679165656"><span class="annot"><a href="ZM.Parser.Types.html#localTypeName"><span class="hs-identifier hs-type">localTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165655"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679165656"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-114"></span><span id="localTypeName"><span class="annot"><span class="annottext">localTypeName :: These a b -&gt; a
</span><a href="ZM.Parser.Types.html#localTypeName"><span class="hs-identifier hs-var hs-var">localTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">These a b -&gt; a
forall c b. These c b -&gt; c
</span><a href="Data.These.Extra.html#fromThis"><span class="hs-identifier hs-var">fromThis</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679165652"><span id="local-6989586621679165653"><span class="annot"><a href="ZM.Parser.Types.html#absTypeName"><span class="hs-identifier hs-type">absTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">These</span></span><span> </span><span class="annot"><a href="#local-6989586621679165653"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679165652"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-117"></span><span id="absTypeName"><span class="annot"><span class="annottext">absTypeName :: These a b -&gt; b
</span><a href="ZM.Parser.Types.html#absTypeName"><span class="hs-identifier hs-var hs-var">absTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">These a b -&gt; b
forall a1 c. These a1 c -&gt; c
</span><a href="Data.These.Extra.html#fromThat"><span class="hs-identifier hs-var">fromThat</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679165650"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165645"><span id="local-6989586621679165648"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679165650"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165650"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679165644"><span class="annot"><span class="annottext">pPrint :: TypeName n -&gt; Doc
</span><a href="#local-6989586621679165644"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(n -&gt; Doc) -&gt; (AbsRef -&gt; Doc) -&gt; TypeName n -&gt; Doc
forall a t1 t2.
Semigroup a =&gt;
(t1 -&gt; a) -&gt; (t2 -&gt; a) -&gt; These t1 t2 -&gt; a
</span><a href="Data.These.Extra.html#both"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679165642"><span class="annot"><span class="annottext">AbsRef
</span><a href="#local-6989586621679165642"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">P.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AbsRef -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">AbsRef
</span><a href="#local-6989586621679165642"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- This a == These a (any b)</span><span>
</span><span id="line-123"></span><span id="local-6989586621679165640"><span id="local-6989586621679165641"></span></span><span class="hs-keyword">data</span><span> </span><span id="Range"><span class="annot"><a href="ZM.Parser.Types.html#Range"><span class="hs-identifier hs-var">Range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Range"><span class="annot"><a href="ZM.Parser.Types.html#Range"><span class="hs-identifier hs-var">Range</span></a></span></span><span> </span><span class="hs-special">{</span><span id="line"><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span class="hs-special">,</span><span> </span><span id="start"><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#start"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span class="hs-special">,</span><span> </span><span id="end"><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#end"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">}</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165630"><span id="local-6989586621679165632"><span id="local-6989586621679165634"><span class="annot"><span class="annottext">Int -&gt; Range -&gt; ShowS
[Range] -&gt; ShowS
Range -&gt; String
(Int -&gt; Range -&gt; ShowS)
-&gt; (Range -&gt; String) -&gt; ([Range] -&gt; ShowS) -&gt; Show Range
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Range] -&gt; ShowS
$cshowList :: [Range] -&gt; ShowS
show :: Range -&gt; String
$cshow :: Range -&gt; String
showsPrec :: Int -&gt; Range -&gt; ShowS
$cshowsPrec :: Int -&gt; Range -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165626"><span id="local-6989586621679165628"><span class="annot"><span class="annottext">Range -&gt; Range -&gt; Bool
(Range -&gt; Range -&gt; Bool) -&gt; (Range -&gt; Range -&gt; Bool) -&gt; Eq Range
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Range -&gt; Range -&gt; Bool
$c/= :: Range -&gt; Range -&gt; Bool
== :: Range -&gt; Range -&gt; Bool
$c== :: Range -&gt; Range -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165610"><span id="local-6989586621679165612"><span id="local-6989586621679165614"><span id="local-6989586621679165616"><span id="local-6989586621679165618"><span id="local-6989586621679165620"><span id="local-6989586621679165622"><span class="annot"><span class="annottext">Eq Range
Eq Range
-&gt; (Range -&gt; Range -&gt; Ordering)
-&gt; (Range -&gt; Range -&gt; Bool)
-&gt; (Range -&gt; Range -&gt; Bool)
-&gt; (Range -&gt; Range -&gt; Bool)
-&gt; (Range -&gt; Range -&gt; Bool)
-&gt; (Range -&gt; Range -&gt; Range)
-&gt; (Range -&gt; Range -&gt; Range)
-&gt; Ord Range
Range -&gt; Range -&gt; Bool
Range -&gt; Range -&gt; Ordering
Range -&gt; Range -&gt; Range
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Range -&gt; Range -&gt; Range
$cmin :: Range -&gt; Range -&gt; Range
max :: Range -&gt; Range -&gt; Range
$cmax :: Range -&gt; Range -&gt; Range
&gt;= :: Range -&gt; Range -&gt; Bool
$c&gt;= :: Range -&gt; Range -&gt; Bool
&gt; :: Range -&gt; Range -&gt; Bool
$c&gt; :: Range -&gt; Range -&gt; Bool
&lt;= :: Range -&gt; Range -&gt; Bool
$c&lt;= :: Range -&gt; Range -&gt; Bool
&lt; :: Range -&gt; Range -&gt; Bool
$c&lt; :: Range -&gt; Range -&gt; Bool
compare :: Range -&gt; Range -&gt; Ordering
$ccompare :: Range -&gt; Range -&gt; Ordering
$cp1Ord :: Eq Range
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Range -&gt; Rep Range x)
-&gt; (forall x. Rep Range x -&gt; Range) -&gt; Generic Range
forall x. Rep Range x -&gt; Range
forall x. Range -&gt; Rep Range x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Range x -&gt; Range
$cfrom :: forall x. Range -&gt; Rep Range x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165600"><span id="local-6989586621679165602"><span id="local-6989586621679165604"><span class="annot"><span class="annottext">Get Range
Range -&gt; Encoding
Range -&gt; Int -&gt; Int
(Range -&gt; Encoding)
-&gt; Get Range -&gt; (Range -&gt; Int -&gt; Int) -&gt; Flat Range
forall a. (a -&gt; Encoding) -&gt; Get a -&gt; (a -&gt; Int -&gt; Int) -&gt; Flat a
size :: Range -&gt; Int -&gt; Int
$csize :: Range -&gt; Int -&gt; Int
decode :: Get Range
$cdecode :: Get Range
encode :: Range -&gt; Encoding
$cencode :: Range -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Flat</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165595"><span class="annot"><span class="annottext">Typeable Range
AsType (Ana Range)
Typeable Range
-&gt; AsType (Ana Range)
-&gt; (Proxy Range -&gt; State Env HType)
-&gt; Model Range
Proxy Range -&gt; State Env HType
forall a.
Typeable a
-&gt; AsType (Ana a) -&gt; (Proxy a -&gt; State Env HType) -&gt; Model a
envType :: Proxy Range -&gt; State Env HType
$cenvType :: Proxy Range -&gt; State Env HType
$cp2Model :: AsType (Ana Range)
$cp1Model :: Typeable Range
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Model</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165589"><span id="local-6989586621679165592"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Range"><span class="hs-identifier hs-type">Range</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679165588"><span class="annot"><span class="annottext">pPrint :: Range -&gt; Doc
</span><a href="#local-6989586621679165588"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span id="local-6989586621679165587"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-129"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-130"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span>
</span><span id="line-131"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; String) -&gt; Word32 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-132"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-133"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; String) -&gt; Word32 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#start"><span class="hs-identifier hs-var hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-134"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#end"><span class="hs-identifier hs-var hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#start"><span class="hs-identifier hs-var hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-135"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-136"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Word32
</span><a href="ZM.Parser.Types.html#end"><span class="hs-identifier hs-var hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679165587"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-138"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">type</span><span> </span><span id="At"><span class="annot"><a href="ZM.Parser.Types.html#At"><span class="hs-identifier hs-var">At</span></a></span></span><span> </span><span id="local-6989586621679165584"><span class="annot"><a href="#local-6989586621679165584"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165584"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span id="AtError"><span class="annot"><a href="ZM.Parser.Types.html#AtError"><span class="hs-identifier hs-var">AtError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#At"><span class="hs-identifier hs-type">At</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">type</span><span> </span><span id="AtId"><span class="annot"><a href="ZM.Parser.Types.html#AtId"><span class="hs-identifier hs-var">AtId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#At"><span class="hs-identifier hs-type">At</span></a></span><span> </span><span class="annot"><a href="ZM.Types.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">type</span><span> </span><span id="AtAbsName"><span class="annot"><a href="ZM.Parser.Types.html#AtAbsName"><span class="hs-identifier hs-var">AtAbsName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#At"><span class="hs-identifier hs-type">At</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="annot"><a href="ZM.Types.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">--- 'Transparent' position-marked envelope</span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="Label"><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span> </span><span id="local-6989586621679165815"><span class="annot"><a href="#local-6989586621679165815"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679165814"><span class="annot"><a href="#local-6989586621679165814"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Label"><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span> </span><span class="hs-special">{</span><span id="label"><span class="annot"><span class="annottext">Label l a -&gt; l
</span><a href="ZM.Parser.Types.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679165815"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span id="object"><span class="annot"><span class="annottext">Label l a -&gt; a
</span><a href="ZM.Parser.Types.html#object"><span class="hs-identifier hs-var hs-var">object</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679165814"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165574"><span id="local-6989586621679165576"><span id="local-6989586621679165578"><span class="annot"><span class="annottext">Int -&gt; Label l a -&gt; ShowS
[Label l a] -&gt; ShowS
Label l a -&gt; String
(Int -&gt; Label l a -&gt; ShowS)
-&gt; (Label l a -&gt; String)
-&gt; ([Label l a] -&gt; ShowS)
-&gt; Show (Label l a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall l a. (Show l, Show a) =&gt; Int -&gt; Label l a -&gt; ShowS
forall l a. (Show l, Show a) =&gt; [Label l a] -&gt; ShowS
forall l a. (Show l, Show a) =&gt; Label l a -&gt; String
showList :: [Label l a] -&gt; ShowS
$cshowList :: forall l a. (Show l, Show a) =&gt; [Label l a] -&gt; ShowS
show :: Label l a -&gt; String
$cshow :: forall l a. (Show l, Show a) =&gt; Label l a -&gt; String
showsPrec :: Int -&gt; Label l a -&gt; ShowS
$cshowsPrec :: forall l a. (Show l, Show a) =&gt; Int -&gt; Label l a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165570"><span id="local-6989586621679165572"><span class="annot"><span class="annottext">a -&gt; Label l b -&gt; Label l a
(a -&gt; b) -&gt; Label l a -&gt; Label l b
(forall a b. (a -&gt; b) -&gt; Label l a -&gt; Label l b)
-&gt; (forall a b. a -&gt; Label l b -&gt; Label l a) -&gt; Functor (Label l)
forall a b. a -&gt; Label l b -&gt; Label l a
forall a b. (a -&gt; b) -&gt; Label l a -&gt; Label l b
forall l a b. a -&gt; Label l b -&gt; Label l a
forall l a b. (a -&gt; b) -&gt; Label l a -&gt; Label l b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Label l b -&gt; Label l a
$c&lt;$ :: forall l a b. a -&gt; Label l b -&gt; Label l a
fmap :: (a -&gt; b) -&gt; Label l a -&gt; Label l b
$cfmap :: forall l a b. (a -&gt; b) -&gt; Label l a -&gt; Label l b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679165567"><span id="local-6989586621679165568"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165562"><span id="local-6989586621679165565"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679165568"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679165567"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165568"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165567"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679165561"><span class="annot"><span class="annottext">pPrint :: Label l a -&gt; Doc
</span><a href="#local-6989586621679165561"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span id="local-6989586621679165560"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679165560"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679165559"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165559"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165559"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">l -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679165560"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621679165557"><span id="local-6989586621679165558"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165554"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679165558"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165557"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165558"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679165553"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679165553"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679165552"><span class="annot"><span class="annottext">== :: Label l p -&gt; Label l p -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679165551"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679165551"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679165553"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679165551"><span class="hs-identifier hs-var">b</span></a></span></span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621679165549"><span id="local-6989586621679165550"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165535"><span id="local-6989586621679165537"><span id="local-6989586621679165539"><span id="local-6989586621679165541"><span id="local-6989586621679165544"><span id="local-6989586621679165546"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679165550"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165549"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165550"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679165534"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165534"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679165533"><span class="annot"><span class="annottext">&lt;= :: Label l a -&gt; Label l a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;=</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679165531"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165531"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165534"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165531"><span class="hs-identifier hs-var">b</span></a></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679165528"><span id="local-6989586621679165529"><span id="local-6989586621679165530"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Convertible</span></span><span> </span><span class="annot"><a href="#local-6989586621679165530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165529"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Convertible</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165528"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165528"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165529"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679165525"><span class="annot"><span class="annottext">safeConvert :: Label l a -&gt; ConvertResult (Label l b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">safeConvert</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span id="local-6989586621679165523"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679165523"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679165522"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165522"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l -&gt; b -&gt; Label l b
forall l a. l -&gt; a -&gt; Label l a
</span><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679165523"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Label l b)
-&gt; Either ConvertError b -&gt; ConvertResult (Label l b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either ConvertError b
forall a b. Convertible a b =&gt; a -&gt; ConvertResult b
</span><span class="hs-identifier hs-var">safeConvert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165522"><span class="hs-identifier hs-var">a</span></a></span></span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679165518"><span id="local-6989586621679165519"><span id="local-6989586621679165520"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Convertible</span></span><span> </span><span class="annot"><a href="#local-6989586621679165520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165519"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Convertible</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165518"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165520"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679165519"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679165516"><span class="annot"><span class="annottext">safeConvert :: Label l a -&gt; ConvertResult b
</span><a href="#local-6989586621679165516"><span class="hs-identifier hs-var hs-var hs-var hs-var">safeConvert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679165515"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165515"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ConvertResult b
forall a b. Convertible a b =&gt; a -&gt; ConvertResult b
</span><span class="hs-identifier hs-var">safeConvert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679165515"><span class="hs-identifier hs-var">a</span></a></span></span></span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- MOVE TO model</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- instance Convertible a a where safeConvert = Right</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">{- |A generic value (used for dynamic decoding)
 data Value =
   Value { valType :: AbsType -- ^Type
         , valName :: String -- ^Constructor name (duplicate info if we have abstype)
         , valBits :: [Bool] -- ^Bit encoding/constructor id
           -- TODO: add field names (same info present in abstype)
         , valFields :: [Value] -- ^Values to which the constructor is applied, if any
         }
   deriving (Eq, Ord, Show, NFData, Generic, Flat)
 data Void
 Value could also be expressed as
 type Value = Val (AbsType, [Bool]) Literal Void
  v0 :: [Value0]
 v0 = [lit (.., [False,True]) (PInt 3)
 |A Pattern matches a subset of values of a ZM Type
 p1 :: [Pattern]
 p1 = [lit &quot;1:1&quot; (PInt 3), Binder &quot;1:2&quot; PWild]
 type Pattern = Val () Literal Binder
 type Value = Val () Literal ()
 data Val annotation lit binder =
     Constr
       annotation
       String -- ^Name of the constructor (e.g. &quot;True&quot;)
       (Either [Val annotation lit binder] [(String, Val annotation lit binder)]) -- ^Constructor parameters, possibly named
     --        } -- ^A standard constructor, e.g. PCon &quot;True&quot; []
-}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">--     -- Constr { cAnnotation :: annotation</span><span>
</span><span id="line-198"></span><span class="hs-comment">--     --        , cName :: String -- ^Name of the constructor (e.g. &quot;True&quot;)</span><span>
</span><span id="line-199"></span><span class="hs-comment">--     --        , cFields :: Either [Val annotation lit binder] [( String</span><span>
</span><span id="line-200"></span><span class="hs-comment">--     --                                                             , Val annotation lit binder)] -- ^Constructor parameters</span><span>
</span><span id="line-201"></span><span class="hs-comment">--     --        } -- ^A standard constructor, e.g. PCon &quot;True&quot; []</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   | lit annotation (lit (Val annotation lit binder)) -- ^A variable or a lit pattern (e.g. a string or a number)</span><span>
</span><span id="line-203"></span><span class="hs-comment">--   | Binder annotation binder -- ^A pattern that might bind a matched value to a name</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   -- deriving (Eq, Ord, Show)</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- deriving instance (Show annotation,Show binder,Show (lit (Val annotation lit binder))) =&gt; Show (Val annotation lit binder)</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- deriving instance (Eq annotation,Eq binder,Eq (lit (Val annotation lit binder))) =&gt; Eq (Val annotation lit binder)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">data</span><span> </span><span id="Void1"><span class="annot"><a href="ZM.Parser.Types.html#Void1"><span class="hs-identifier hs-var">Void1</span></a></span></span><span> </span><span id="local-6989586621679165514"><span class="annot"><a href="#local-6989586621679165514"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">data</span><span> </span><span id="Annotate"><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-var">Annotate</span></a></span></span><span> </span><span id="local-6989586621679165513"><span class="annot"><a href="#local-6989586621679165513"><span class="hs-keyword hs-type">label</span></a></span></span><span> </span><span id="local-6989586621679165512"><span class="annot"><a href="#local-6989586621679165512"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Annotate"><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-var">Annotate</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679165513"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165512"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165513"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165512"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679165505"><span id="local-6989586621679165507"><span id="local-6989586621679165509"><span id="local-6989586621679165510"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679165510"><span class="hs-keyword hs-type">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165509"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165510"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165509"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165510"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165509"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679165488"><span id="local-6989586621679165490"><span id="local-6989586621679165492"><span id="local-6989586621679165494"><span id="local-6989586621679165496"><span id="local-6989586621679165498"><span id="local-6989586621679165500"><span id="local-6989586621679165503"><span id="local-6989586621679165504"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679165504"><span class="hs-keyword hs-type">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165503"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165504"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165503"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165504"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165503"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span id="local-6989586621679165480"><span id="local-6989586621679165482"><span id="local-6989586621679165484"><span id="local-6989586621679165486"><span id="local-6989586621679165487"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679165487"><span class="hs-keyword hs-type">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165486"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165487"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165486"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165487"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165486"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">type</span><span> </span><span id="Val"><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span> </span><span id="local-6989586621679165479"><span class="annot"><a href="#local-6989586621679165479"><span class="hs-identifier hs-type">lit</span></a></span></span><span> </span><span id="local-6989586621679165478"><span class="annot"><a href="#local-6989586621679165478"><span class="hs-identifier hs-type">binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165479"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165478"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">data</span><span> </span><span id="ValF"><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-var">ValF</span></a></span></span><span> </span><span id="local-6989586621679165477"><span class="annot"><a href="#local-6989586621679165477"><span class="hs-identifier hs-type">lit</span></a></span></span><span> </span><span id="local-6989586621679165476"><span class="annot"><a href="#local-6989586621679165476"><span class="hs-identifier hs-type">binder</span></a></span></span><span> </span><span id="local-6989586621679165475"><span class="annot"><a href="#local-6989586621679165475"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ConstrF"><span class="annot"><a href="ZM.Parser.Types.html#ConstrF"><span class="hs-identifier hs-var">ConstrF</span></a></span></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-comment">-- ^Name of the constructor (e.g. &quot;True&quot;)</span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679165475"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679165475"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-comment">-- ^Constructor parameters, possibly named</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-comment">--        } -- ^A standard constructor, e.g. PCon &quot;True&quot; []</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- |A variable or a lit pattern (e.g. a string or a number)</span><span>
</span><span id="line-228"></span><span>      </span><span id="LitF"><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-var">LitF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165477"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165475"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- |A pattern that might bind a matched value to a name</span><span>
</span><span id="line-230"></span><span>      </span><span id="BinderF"><span class="annot"><a href="ZM.Parser.Types.html#BinderF"><span class="hs-identifier hs-var">BinderF</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679165476"><span class="hs-identifier hs-type">binder</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621679165465"><span id="local-6989586621679165467"><span id="local-6989586621679165469"><span id="local-6989586621679165470"><span id="local-6989586621679165471"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679165471"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679165470"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165469"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165471"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165469"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165470"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165471"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621679165447"><span id="local-6989586621679165449"><span id="local-6989586621679165451"><span id="local-6989586621679165453"><span id="local-6989586621679165455"><span id="local-6989586621679165457"><span id="local-6989586621679165459"><span id="local-6989586621679165462"><span id="local-6989586621679165463"><span id="local-6989586621679165464"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679165464"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679165463"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165462"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165464"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165462"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165463"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165464"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span id="local-6989586621679165438"><span id="local-6989586621679165440"><span id="local-6989586621679165442"><span id="local-6989586621679165444"><span id="local-6989586621679165445"><span id="local-6989586621679165446"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679165446"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679165445"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165444"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165446"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165444"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165445"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165446"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">{-
type Pat = Val Literal Binder

ps :: [Pat]
ps = [PWild,PBind &quot;a&quot;]

y = map show ps

vs :: [Pat]
vs = [Fix (BinderF Wild),Fix (LitF (LInteger 2)),Fix (LitF (LArray [Fix (BinderF (Bind &quot;a&quot;))])), Fix (ConstrF &quot;Nil&quot; (Left [])),Fix (ConstrF &quot;Cons&quot; (Right [(&quot;p1&quot;,Fix (BinderF Wild))]))]

p = Constr &quot;C&quot; (Left [PBind &quot;h&quot;])

type VA label lit binder = Annotate label (ValF lit binder)
-}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679165788"><span id="local-6989586621679165789"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165789"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165788"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165789"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165788"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165789"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165788"><span class="hs-identifier hs-type">binder</span></a></span></span></span><span>
</span><span id="line-258"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bConstr"><span id="%24mConstr"><span id="Constr"><span class="annot"><span class="annottext">$bConstr :: String
-&gt; Either [Val lit binder] [(String, Val lit binder)]
-&gt; Val lit binder
$mConstr :: forall r (lit :: * -&gt; *) binder.
Val lit binder
-&gt; (String
    -&gt; Either [Val lit binder] [(String, Val lit binder)] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="ZM.Parser.Types.html#%24bConstr"><span class="hs-identifier hs-var hs-var hs-var">Constr</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165435"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165434"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ConstrF"><span class="hs-identifier hs-type">ConstrF</span></a></span><span> </span><span id="local-6989586621679165435"><span class="annot"><a href="#local-6989586621679165435"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679165434"><span class="annot"><a href="#local-6989586621679165434"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679165782"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VInteger"><span class="hs-identifier hs-type">VInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165782"><span class="hs-identifier hs-type">binder</span></a></span></span><span>
</span><span id="line-261"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bVInteger"><span id="%24mVInteger"><span id="VInteger"><span class="annot"><span class="annottext">$bVInteger :: Integer -&gt; Val Literal binder
$mVInteger :: forall r binder.
Val Literal binder -&gt; (Integer -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bVInteger"><span class="hs-identifier hs-var hs-var hs-var">VInteger</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165430"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-type">LitF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LInteger"><span class="hs-identifier hs-type">LInteger</span></a></span><span> </span><span id="local-6989586621679165430"><span class="annot"><a href="#local-6989586621679165430"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span id="local-6989586621679165778"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VFloat"><span class="hs-identifier hs-type">VFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165778"><span class="hs-identifier hs-type">binder</span></a></span></span><span>
</span><span id="line-264"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bVFloat"><span id="%24mVFloat"><span id="VFloat"><span class="annot"><span class="annottext">$bVFloat :: Double -&gt; Val Literal binder
$mVFloat :: forall r binder.
Val Literal binder -&gt; (Double -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bVFloat"><span class="hs-identifier hs-var hs-var hs-var">VFloat</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165426"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-type">LitF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LFloat"><span class="hs-identifier hs-type">LFloat</span></a></span><span> </span><span id="local-6989586621679165426"><span class="annot"><a href="#local-6989586621679165426"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621679165774"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VChar"><span class="hs-identifier hs-type">VChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165774"><span class="hs-identifier hs-type">binder</span></a></span></span><span>
</span><span id="line-267"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bVChar"><span id="%24mVChar"><span id="VChar"><span class="annot"><span class="annottext">$bVChar :: Char -&gt; Val Literal binder
$mVChar :: forall r binder.
Val Literal binder -&gt; (Char -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bVChar"><span class="hs-identifier hs-var hs-var hs-var">VChar</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165422"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-type">LitF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LChar"><span class="hs-identifier hs-type">LChar</span></a></span><span> </span><span id="local-6989586621679165422"><span class="annot"><a href="#local-6989586621679165422"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621679165770"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VString"><span class="hs-identifier hs-type">VString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165770"><span class="hs-identifier hs-type">binder</span></a></span></span><span>
</span><span id="line-270"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bVString"><span id="%24mVString"><span id="VString"><span class="annot"><span class="annottext">$bVString :: String -&gt; Val Literal binder
$mVString :: forall r binder.
Val Literal binder -&gt; (String -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bVString"><span class="hs-identifier hs-var hs-var hs-var">VString</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165418"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-type">LitF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LString"><span class="hs-identifier hs-type">LString</span></a></span><span> </span><span id="local-6989586621679165418"><span class="annot"><a href="#local-6989586621679165418"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span id="local-6989586621679165766"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#VArray"><span class="hs-identifier hs-type">VArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165766"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165766"><span class="hs-identifier hs-type">binder</span></a></span></span><span>
</span><span id="line-273"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bVArray"><span id="%24mVArray"><span id="VArray"><span class="annot"><span class="annottext">$bVArray :: [Val Literal binder] -&gt; Val Literal binder
$mVArray :: forall r binder.
Val Literal binder
-&gt; ([Val Literal binder] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bVArray"><span class="hs-identifier hs-var hs-var hs-var">VArray</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165414"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LitF"><span class="hs-identifier hs-type">LitF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#LArray"><span class="hs-identifier hs-type">LArray</span></a></span><span> </span><span id="local-6989586621679165414"><span class="annot"><a href="#local-6989586621679165414"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span id="local-6989586621679165762"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#PWild"><span class="hs-identifier hs-type">PWild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165762"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span></span><span>
</span><span id="line-276"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPWild"><span id="%24mPWild"><span id="PWild"><span class="annot"><span class="annottext">$bPWild :: Val lit Binder
$mPWild :: forall r (lit :: * -&gt; *).
Val lit Binder -&gt; (Void# -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bPWild"><span class="hs-identifier hs-var hs-var hs-var">PWild</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#BinderF"><span class="hs-identifier hs-type">BinderF</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Wild"><span class="hs-identifier hs-type">Wild</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621679165758"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#PBind"><span class="hs-identifier hs-type">PBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165758"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span></span><span>
</span><span id="line-279"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPBind"><span id="%24mPBind"><span id="PBind"><span class="annot"><span class="annottext">$bPBind :: String -&gt; Val lit Binder
$mPBind :: forall r (lit :: * -&gt; *).
Val lit Binder -&gt; (String -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="ZM.Parser.Types.html#%24bPBind"><span class="hs-identifier hs-var hs-var hs-var">PBind</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679165407"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#BinderF"><span class="hs-identifier hs-type">BinderF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span id="local-6989586621679165407"><span class="annot"><a href="#local-6989586621679165407"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">--instance Model v =&gt; Model (Pat v)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">data</span><span> </span><span id="Literal"><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span></span><span> </span><span id="local-6989586621679165405"><span class="annot"><a href="#local-6989586621679165405"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="LInteger"><span class="annot"><a href="ZM.Parser.Types.html#LInteger"><span class="hs-identifier hs-var">LInteger</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LFloat"><span class="annot"><a href="ZM.Parser.Types.html#LFloat"><span class="hs-identifier hs-var">LFloat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-comment">-- Rational</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LChar"><span class="annot"><a href="ZM.Parser.Types.html#LChar"><span class="hs-identifier hs-var">LChar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LString"><span class="annot"><a href="ZM.Parser.Types.html#LString"><span class="hs-identifier hs-var">LString</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LArray"><span class="annot"><a href="ZM.Parser.Types.html#LArray"><span class="hs-identifier hs-var">LArray</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679165405"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165401"><span id="local-6989586621679165403"><span class="annot"><span class="annottext">Literal e -&gt; Literal e -&gt; Bool
(Literal e -&gt; Literal e -&gt; Bool)
-&gt; (Literal e -&gt; Literal e -&gt; Bool) -&gt; Eq (Literal e)
forall e. Eq e =&gt; Literal e -&gt; Literal e -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Literal e -&gt; Literal e -&gt; Bool
$c/= :: forall e. Eq e =&gt; Literal e -&gt; Literal e -&gt; Bool
== :: Literal e -&gt; Literal e -&gt; Bool
$c== :: forall e. Eq e =&gt; Literal e -&gt; Literal e -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165386"><span id="local-6989586621679165388"><span id="local-6989586621679165390"><span id="local-6989586621679165392"><span id="local-6989586621679165394"><span id="local-6989586621679165396"><span id="local-6989586621679165398"><span class="annot"><span class="annottext">Eq (Literal e)
Eq (Literal e)
-&gt; (Literal e -&gt; Literal e -&gt; Ordering)
-&gt; (Literal e -&gt; Literal e -&gt; Bool)
-&gt; (Literal e -&gt; Literal e -&gt; Bool)
-&gt; (Literal e -&gt; Literal e -&gt; Bool)
-&gt; (Literal e -&gt; Literal e -&gt; Bool)
-&gt; (Literal e -&gt; Literal e -&gt; Literal e)
-&gt; (Literal e -&gt; Literal e -&gt; Literal e)
-&gt; Ord (Literal e)
Literal e -&gt; Literal e -&gt; Bool
Literal e -&gt; Literal e -&gt; Ordering
Literal e -&gt; Literal e -&gt; Literal e
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall e. Ord e =&gt; Eq (Literal e)
forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Bool
forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Ordering
forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Literal e
min :: Literal e -&gt; Literal e -&gt; Literal e
$cmin :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Literal e
max :: Literal e -&gt; Literal e -&gt; Literal e
$cmax :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Literal e
&gt;= :: Literal e -&gt; Literal e -&gt; Bool
$c&gt;= :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Bool
&gt; :: Literal e -&gt; Literal e -&gt; Bool
$c&gt; :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Bool
&lt;= :: Literal e -&gt; Literal e -&gt; Bool
$c&lt;= :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Bool
&lt; :: Literal e -&gt; Literal e -&gt; Bool
$c&lt; :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Bool
compare :: Literal e -&gt; Literal e -&gt; Ordering
$ccompare :: forall e. Ord e =&gt; Literal e -&gt; Literal e -&gt; Ordering
$cp1Ord :: forall e. Ord e =&gt; Eq (Literal e)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165380"><span id="local-6989586621679165382"><span id="local-6989586621679165384"><span class="annot"><span class="annottext">Int -&gt; Literal e -&gt; ShowS
[Literal e] -&gt; ShowS
Literal e -&gt; String
(Int -&gt; Literal e -&gt; ShowS)
-&gt; (Literal e -&gt; String)
-&gt; ([Literal e] -&gt; ShowS)
-&gt; Show (Literal e)
forall e. Show e =&gt; Int -&gt; Literal e -&gt; ShowS
forall e. Show e =&gt; [Literal e] -&gt; ShowS
forall e. Show e =&gt; Literal e -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Literal e] -&gt; ShowS
$cshowList :: forall e. Show e =&gt; [Literal e] -&gt; ShowS
show :: Literal e -&gt; String
$cshow :: forall e. Show e =&gt; Literal e -&gt; String
showsPrec :: Int -&gt; Literal e -&gt; ShowS
$cshowsPrec :: forall e. Show e =&gt; Int -&gt; Literal e -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">data</span><span> </span><span id="Binder"><span class="annot"><a href="ZM.Parser.Types.html#Binder"><span class="hs-identifier hs-var">Binder</span></a></span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Wild"><span class="annot"><a href="ZM.Parser.Types.html#Wild"><span class="hs-identifier hs-var">Wild</span></a></span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Bind"><span class="annot"><a href="ZM.Parser.Types.html#Bind"><span class="hs-identifier hs-var">Bind</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165376"><span id="local-6989586621679165378"><span class="annot"><span class="annottext">Binder -&gt; Binder -&gt; Bool
(Binder -&gt; Binder -&gt; Bool)
-&gt; (Binder -&gt; Binder -&gt; Bool) -&gt; Eq Binder
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Binder -&gt; Binder -&gt; Bool
$c/= :: Binder -&gt; Binder -&gt; Bool
== :: Binder -&gt; Binder -&gt; Bool
$c== :: Binder -&gt; Binder -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165361"><span id="local-6989586621679165363"><span id="local-6989586621679165365"><span id="local-6989586621679165367"><span id="local-6989586621679165369"><span id="local-6989586621679165371"><span id="local-6989586621679165373"><span class="annot"><span class="annottext">Eq Binder
Eq Binder
-&gt; (Binder -&gt; Binder -&gt; Ordering)
-&gt; (Binder -&gt; Binder -&gt; Bool)
-&gt; (Binder -&gt; Binder -&gt; Bool)
-&gt; (Binder -&gt; Binder -&gt; Bool)
-&gt; (Binder -&gt; Binder -&gt; Bool)
-&gt; (Binder -&gt; Binder -&gt; Binder)
-&gt; (Binder -&gt; Binder -&gt; Binder)
-&gt; Ord Binder
Binder -&gt; Binder -&gt; Bool
Binder -&gt; Binder -&gt; Ordering
Binder -&gt; Binder -&gt; Binder
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Binder -&gt; Binder -&gt; Binder
$cmin :: Binder -&gt; Binder -&gt; Binder
max :: Binder -&gt; Binder -&gt; Binder
$cmax :: Binder -&gt; Binder -&gt; Binder
&gt;= :: Binder -&gt; Binder -&gt; Bool
$c&gt;= :: Binder -&gt; Binder -&gt; Bool
&gt; :: Binder -&gt; Binder -&gt; Bool
$c&gt; :: Binder -&gt; Binder -&gt; Bool
&lt;= :: Binder -&gt; Binder -&gt; Bool
$c&lt;= :: Binder -&gt; Binder -&gt; Bool
&lt; :: Binder -&gt; Binder -&gt; Bool
$c&lt; :: Binder -&gt; Binder -&gt; Bool
compare :: Binder -&gt; Binder -&gt; Ordering
$ccompare :: Binder -&gt; Binder -&gt; Ordering
$cp1Ord :: Eq Binder
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165355"><span id="local-6989586621679165357"><span id="local-6989586621679165359"><span class="annot"><span class="annottext">Int -&gt; Binder -&gt; ShowS
[Binder] -&gt; ShowS
Binder -&gt; String
(Int -&gt; Binder -&gt; ShowS)
-&gt; (Binder -&gt; String) -&gt; ([Binder] -&gt; ShowS) -&gt; Show Binder
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Binder] -&gt; ShowS
$cshowList :: [Binder] -&gt; ShowS
show :: Binder -&gt; String
$cshow :: Binder -&gt; String
showsPrec :: Int -&gt; Binder -&gt; ShowS
$cshowsPrec :: Int -&gt; Binder -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">type</span><span> </span><span id="Value"><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier hs-var">Value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Types.html#AbsType"><span class="hs-identifier hs-type">AbsType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679165751"><span class="annot"><a href="#local-6989586621679165751"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679165750"><span class="annot"><a href="#local-6989586621679165750"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679165749"><span class="annot"><a href="#local-6989586621679165749"><span class="hs-identifier hs-type">lit</span></a></span></span><span> </span><span id="local-6989586621679165748"><span class="annot"><a href="#local-6989586621679165748"><span class="hs-identifier hs-type">binder</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621679165751"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="#local-6989586621679165750"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165751"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679165750"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165749"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165748"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679165751"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679165750"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ValF"><span class="hs-identifier hs-type">ValF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165749"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679165748"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bValue"><span id="%24mValue"><span id="Value"><span class="annot"><span class="annottext">$bValue :: a
-&gt; String
-&gt; b
-&gt; [Annotate (a, b) (ValF lit binder)]
-&gt; Annotate (a, b) (ValF lit binder)
$mValue :: forall r a b (lit :: * -&gt; *) binder.
Annotate (a, b) (ValF lit binder)
-&gt; (a -&gt; String -&gt; b -&gt; [Annotate (a, b) (ValF lit binder)] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="ZM.Parser.Types.html#%24bValue"><span class="hs-identifier hs-var hs-var hs-var">Value</span></a></span></span></span></span><span class="hs-special">{</span><span id="valType"><span class="annot"><span class="annottext">Annotate (a, b) (ValF lit binder) -&gt; a
</span><a href="#local-6989586621679165351"><span class="hs-identifier hs-var hs-var hs-var">valType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="valName"><span class="annot"><span class="annottext">Annotate (a, b) (ValF lit binder) -&gt; String
</span><a href="#local-6989586621679165350"><span class="hs-identifier hs-var hs-var hs-var">valName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="valBits"><span class="annot"><span class="annottext">Annotate (a, b) (ValF lit binder) -&gt; b
</span><a href="#local-6989586621679165349"><span class="hs-identifier hs-var hs-var hs-var">valBits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="valFields"><span class="annot"><span class="annottext">Annotate (a, b) (ValF lit binder)
-&gt; [Annotate (a, b) (ValF lit binder)]
</span><a href="#local-6989586621679165348"><span class="hs-identifier hs-var hs-var hs-var">valFields</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679165351"><span class="annot"><a href="#local-6989586621679165351"><span class="hs-identifier hs-var">valType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679165349"><span class="annot"><a href="#local-6989586621679165349"><span class="hs-identifier hs-var">valBits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ZM.Parser.Types.html#ConstrF"><span class="hs-identifier hs-type">ConstrF</span></a></span><span> </span><span id="local-6989586621679165350"><span class="annot"><a href="#local-6989586621679165350"><span class="hs-identifier hs-var">valName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679165348"><span class="annot"><a href="#local-6989586621679165348"><span class="hs-identifier hs-var">valFields</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679165343"><span id="local-6989586621679165346"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pPrint</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ZM.Parser.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679165342"><span class="annot"><span class="annottext">pPrint :: Value -&gt; Doc
</span><a href="#local-6989586621679165342"><span class="hs-identifier hs-var hs-var hs-var hs-var">pPrint</span></a></span></span><span> </span><span id="local-6989586621679165341"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679165341"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679165340"><span class="annot"><span class="annottext">hasFields :: Bool
</span><a href="#local-6989586621679165340"><span class="hs-identifier hs-var hs-var">hasFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; [Value]
forall a b (lit :: * -&gt; *) binder.
Annotate (a, b) (ValF lit binder)
-&gt; [Annotate (a, b) (ValF lit binder)]
</span><a href="ZM.Parser.Types.html#valFields"><span class="hs-identifier hs-var">valFields</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679165341"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>            </span><span id="local-6989586621679165337"><span class="annot"><span class="annottext">start :: Doc
</span><a href="#local-6989586621679165337"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679165340"><span class="hs-identifier hs-var">hasFields</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-312"></span><span>            </span><span id="local-6989586621679165336"><span class="annot"><span class="annottext">end :: Doc
</span><a href="#local-6989586621679165336"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679165340"><span class="hs-identifier hs-var">hasFields</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-313"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679165337"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-314"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; String
forall a b (lit :: * -&gt; *) binder.
Annotate (a, b) (ValF lit binder) -&gt; String
</span><a href="ZM.Parser.Types.html#valName"><span class="hs-identifier hs-var">valName</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679165341"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-316"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Doc) -&gt; [Value] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">pPrint</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; [Value]
forall a b (lit :: * -&gt; *) binder.
Annotate (a, b) (ValF lit binder)
-&gt; [Annotate (a, b) (ValF lit binder)]
</span><a href="ZM.Parser.Types.html#valFields"><span class="hs-identifier hs-var">valFields</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679165341"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679165336"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-318"></span></pre></body></html>